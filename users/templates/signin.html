{% extends "landingbase.html" %}
{% load staticfiles %}
{% block localhead %}
  <!-- CSS -->
  <style type="text/css">
  .css-form input.ng-invalid.ng-dirty {
    border-color: rgba(232,77,60,1.00);
  }

  .css-form input.ng-valid.ng-dirty {
    border-color: rgba(47,204,112,1.00);
  } 
</style>
  
<link href={% static "app/css/bootstrap.min.css" %} rel="stylesheet">
    <link href={% static "app/css/animate.css" %} rel="stylesheet">
    <link href={% static "app/css/style.css" %} rel="stylesheet">

{% endblock localhead %}
{% block content %} 



<div class="middle-box text-center loginscreen  animated fadeInDown" ng-app="validation">
        <div ng-controller="Validation">
            <div>

            
            </div>
            <h3>Welcome to Questr</h3>
            <p>
                
            </p>
            <p></p>
            
            
            {% if next %}
            <form class="m-t css-form" role="form" name="form" action="/user/signin/?next={{next}}" method="post" novalidate>{% csrf_token %}
                <div class="form-group" ng-controller="Validation">
                    <input type="email" class="form-control" id="username" name="username" ng-model="user.email" placeholder="Email Address" required />
                    <p> 
                        {% if auth_form.username.errors %}
                          {{ auth_form.username.errors }}
                        {% endif %}
                        </p>
                        <div class="help-block with-errors"></div>
                </div>
                
                <div class="form-group">
                    <input id="password" type="password" class="form-control" name="password" id="exampleInputPassword1" ng-minlength="6" ng-maxlength="20" placeholder="Password" ng-model="user.password" required />
                    <p> 
                      {% if auth_form.password.errors %}
                      {{ auth_form.password.errors }}
                      {% endif %}
                      {% if auth_form.errors %}
                          {{ auth_form.non_field_errors }}
                      {% endif %}
                        </p>
                </div>
                <button type="submit" class="btn btn-primary block full-width m-b" ng-disabled="form.$invalid">Login</button>

                <a href="{% url 'reset_password' %}"><small>Forgot password?</small></a>
                {% comment %}
                  <p class="text-muted text-center"><small>Do not have an account?</small></p>
                  <a class="btn btn-sm btn-white btn-block" href="">Create an account</a>
                {% endcomment %}
            </form>
            
            {% else %}
            <form class="m-t css-form" role="form" name="form" action="{%url 'signin'%}" method="post" novalidate>{% csrf_token %}
                <div class="form-group" ng-controller="Validation">
                    <input type="email" class="form-control" id="username" name="username" ng-model="user.email" placeholder="Email Address" required />
                    <p> 
                        {% if auth_form.username.errors %}
                          {{ auth_form.username.errors }}
                        {% endif %}
                        </p>
                        <div class="help-block with-errors"></div>
                </div>
                
                <div class="form-group">
                    <input  id="password" type="password" class="form-control" name="password" id="exampleInputPassword1" ng-minlength="6" ng-maxlength="20" placeholder="Password" ng-model="user.password" required />
                    <p> 
                      {% if auth_form.password.errors %}
                      {{ auth_form.password.errors }}
                      {% endif %}
                      {% if auth_form.errors %}
                          {{ auth_form.non_field_errors }}
                      {% endif %}
                        </p>
                </div>
                <button type="submit" class="btn btn-primary block full-width m-b" ng-disabled="form.$invalid || isUnchanged(user)">Login</button>

                <a href="{% url 'reset_password' %}"><small>Forgot password?</small></a>
              {% comment %}
                <p class="text-muted text-center"><small>Do not have an account?</small></p>
                <a class="btn btn-sm btn-white btn-block" href="">Create an account</a>
              {% endcomment %}
            </form>
            {% endif %}
            <p class="m-t"> <small>Questr is powered by <a href="http://earthand.co/en/" target="_blank">Earth and Co</a> &copy; 2014</small> </p>
        </div>
    </div>

    
{% comment %}
  	<center>
    	<h6>Sign in with</h6>
              <a href="{% url 'social:begin' 'facebook' %}"><button class="btn btn-facebook"><i class="fa fa-facebook"></i></button></a>
              <a href="{% url 'social:begin' 'twitter' %}"><button class="btn btn-twitter"><i class="fa fa-twitter"></i></button></a>
            
            
            ## This is for google plus based authentication ##
                {% if plus_id %}
                <form id="google-plus" method="post" action="{% url 'social:complete' 'google-plus' %}">{% csrf_token %}
                  <input id="at" type="hidden" name="access_token" value="" />
                  <input id="code" type="hidden" name="code" value="" />
    
                  <div id="signinButton">
                    <span class="g-signin" data-scope="{{ plus_scope }}"
                                           data-clientid="{{ plus_id }}"
                                           data-redirecturi="postmessage"
                                           data-accesstype="offline"
                                           data-cookiepolicy="single_host_origin"
                                           data-callback="signInCallback">
                    </span>
                  </div>
                </form>
                {% endif %}
            
            
            <a href="{% url 'social:begin' 'google-oauth2' %}"><button class="btn btn-google-plus"><i class="fa fa-google-plus"></i></button></a> 
      	</center>
{% endcomment %}

{% endblock %}
{% block scripts %}
  <script>
  angular.module('validation', [])
    .controller('Validation', ['$scope', function($scope) {
      $scope.master = {};

      $scope.update = function(user) {
        $scope.master = angular.copy(user);
      };

      $scope.reset = function() {
        $scope.user = angular.copy($scope.master);
      };

      $scope.isUnchanged = function(user) {
      return angular.equals(user, $scope.master);
    };

      $scope.reset();
    }]);
</script>

<script src={% static "app/js/jquery-2.1.1.js" %}></script>
    <script src={% static "app/js/bootstrap.min.js" %}></script>
{% endblock scripts %}